{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-dom.ts","../../../../node_modules/%40swc/helpers/cjs/_interop_require_default.cjs","../../../../node_modules/next/src/shared/lib/image-external.tsx","../../../../node_modules/next/image.js","../../../../src/app/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactDOM\n","\"use strict\";\n\nfunction _interop_require_default(obj) {\n    return obj && obj.__esModule ? obj : { default: obj };\n}\nexports._ = _interop_require_default;\n","import type { ImageConfigComplete, ImageLoaderProps } from './image-config'\nimport type { ImageProps, ImageLoader, StaticImageData } from './get-img-props'\n\nimport { getImgProps } from './get-img-props'\nimport { Image } from '../../client/image-component'\n\n// This is replaced by webpack alias\nimport defaultLoader from 'next/dist/shared/lib/image-loader'\n\n/**\n * For more advanced use cases, you can call `getImageProps()`\n * to get the props that would be passed to the underlying `<img>` element,\n * and instead pass to them to another component, style, canvas, etc.\n *\n * Read more: [Next.js docs: `getImageProps`](https://nextjs.org/docs/app/api-reference/components/image#getimageprops)\n */\nexport function getImageProps(imgProps: ImageProps) {\n  const { props } = getImgProps(imgProps, {\n    defaultLoader,\n    // This is replaced by webpack define plugin\n    imgConf: process.env.__NEXT_IMAGE_OPTS as any as ImageConfigComplete,\n  })\n  // Normally we don't care about undefined props because we pass to JSX,\n  // but this exported function could be used by the end user for anything\n  // so we delete undefined props to clean it up a little.\n  for (const [key, value] of Object.entries(props)) {\n    if (value === undefined) {\n      delete props[key as keyof typeof props]\n    }\n  }\n  return { props }\n}\n\nexport default Image\n\nexport type { ImageProps, ImageLoaderProps, ImageLoader, StaticImageData }\n","module.exports = require('./dist/shared/lib/image-external')\n","\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { authFetch } from \"@/lib/authFetch\";\n\ntype Product = {\n  id: number;\n  name: string;\n  price: number;\n  stock: number;\n  store: {\n    id: number;\n    name: string;\n    clusterId: string;\n  };\n};\n\nconst productImages = [\n  \"https://images.unsplash.com/photo-1582655299221-2b6bff351df0?auto=format&fit=crop&w=900&q=80\",\n  \"https://images.unsplash.com/photo-1549931319-a545dcf3bc73?auto=format&fit=crop&w=900&q=80\",\n  \"https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?auto=format&fit=crop&w=900&q=80\",\n  \"https://images.unsplash.com/photo-1517701550927-30cf4ba1f5f5?auto=format&fit=crop&w=900&q=80\",\n];\n\nexport default function HomePage() {\n  const [products, setProducts] = useState<Product[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [pendingProductIds, setPendingProductIds] = useState<Set<number>>(new Set());\n  const [feedbackByProductId, setFeedbackByProductId] = useState<Record<number, string>>({});\n\n  useEffect(() => {\n    let active = true;\n\n    async function loadProducts() {\n      try {\n        setLoading(true);\n        setError(null);\n\n        const response = await fetch(\"/api/products\");\n        if (!response.ok) {\n          throw new Error(\"Unable to load products right now.\");\n        }\n\n        const data = (await response.json()) as Product[];\n        if (!active) {\n          return;\n        }\n\n        setProducts(Array.isArray(data) ? data : []);\n      } catch (err) {\n        if (!active) {\n          return;\n        }\n\n        const message =\n          err instanceof Error ? err.message : \"Something went wrong while loading products.\";\n        setError(message);\n      } finally {\n        if (active) {\n          setLoading(false);\n        }\n      }\n    }\n\n    void loadProducts();\n\n    return () => {\n      active = false;\n    };\n  }, []);\n\n  const displayProducts = useMemo(() => products.slice(0, 8), [products]);\n\n  async function handleAddToCart(productId: number) {\n    setPendingProductIds((prev) => {\n      const next = new Set(prev);\n      next.add(productId);\n      return next;\n    });\n    setFeedbackByProductId((prev) => ({ ...prev, [productId]: \"\" }));\n\n    try {\n      const response = await authFetch(\"/api/cart\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ productId, quantity: 1 }),\n      });\n\n      const data = (await response.json()) as { message?: string };\n      if (!response.ok) {\n        throw new Error(data.message ?? \"Failed to add to cart.\");\n      }\n\n      setFeedbackByProductId((prev) => ({ ...prev, [productId]: \"Added to cart.\" }));\n    } catch (err) {\n      const message =\n        err instanceof Error ? err.message : \"Unable to add this product right now.\";\n      setFeedbackByProductId((prev) => ({ ...prev, [productId]: message }));\n    } finally {\n      setPendingProductIds((prev) => {\n        const next = new Set(prev);\n        next.delete(productId);\n        return next;\n      });\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-black text-white\">\n      <main className=\"mx-auto max-w-7xl px-6 py-16\">\n        <section className=\"mx-auto max-w-4xl text-center\">\n          <h1 className=\"text-5xl font-bold leading-tight\">Discover What&apos;s Near You</h1>\n          <p className=\"mt-4 text-lg text-zinc-400\">\n            Support local businesses and get fresh products delivered to your door\n          </p>\n\n          <div className=\"mx-auto mt-10 flex max-w-4xl flex-col gap-4 sm:flex-row\">\n            <div className=\"flex flex-1 items-center rounded-lg border border-zinc-800 bg-zinc-900 px-4 py-3\">\n              <svg\n                aria-hidden=\"true\"\n                className=\"mr-3 h-5 w-5 text-zinc-500\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <circle cx=\"11\" cy=\"11\" r=\"7\" stroke=\"currentColor\" strokeWidth=\"2\" />\n                <path d=\"M20 20L17 17\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeWidth=\"2\" />\n              </svg>\n              <input\n                className=\"w-full bg-transparent text-zinc-100 outline-none placeholder:text-zinc-500\"\n                placeholder=\"Search products, stores...\"\n                type=\"text\"\n              />\n            </div>\n\n            <button\n              className=\"rounded-lg bg-zinc-800 px-6 py-3 text-sm font-medium text-zinc-100 transition hover:bg-zinc-700\"\n              type=\"button\"\n            >\n              Location\n            </button>\n          </div>\n        </section>\n\n        <section className=\"mt-20\">\n          <h2 className=\"text-2xl font-semibold\">Available Products</h2>\n          {loading ? (\n            <div className=\"mt-6 rounded-xl border border-zinc-800 bg-zinc-900 p-6 text-zinc-300\">\n              Loading products...\n            </div>\n          ) : error ? (\n            <div className=\"mt-6 rounded-xl border border-red-900/40 bg-red-950/20 p-6 text-red-300\">\n              {error}\n            </div>\n          ) : displayProducts.length === 0 ? (\n            <div className=\"mt-6 rounded-xl border border-zinc-800 bg-zinc-900 p-6 text-zinc-400\">\n              No products available at the moment.\n            </div>\n          ) : (\n            <div className=\"mt-6 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4\">\n              {displayProducts.map((product, index) => {\n                const pending = pendingProductIds.has(product.id);\n                const outOfStock = product.stock <= 0;\n                const feedback = feedbackByProductId[product.id];\n\n                return (\n                  <article\n                    className=\"overflow-hidden rounded-2xl border border-zinc-800 bg-zinc-900/95\"\n                    key={product.id}\n                  >\n                    <Link className=\"block\" href={`/products/${product.id}`}>\n                      <div className=\"relative aspect-[4/3] w-full\">\n                        <Image\n                          alt={product.name}\n                          className=\"h-full w-full object-cover\"\n                          fill\n                          sizes=\"(max-width: 768px) 100vw, 25vw\"\n                          src={productImages[index % productImages.length]}\n                        />\n                      </div>\n                    </Link>\n                    <div className=\"p-5\">\n                      <Link\n                        className=\"line-clamp-1 text-[1.75rem]/7 font-semibold tracking-tight text-zinc-100 transition hover:text-white\"\n                        href={`/products/${product.id}`}\n                      >\n                        {product.name}\n                      </Link>\n                      <p className=\"mt-1 text-xl font-medium text-zinc-400\">{product.store.name}</p>\n\n                      <div className=\"mt-4 flex items-center justify-between\">\n                        <p className=\"text-[2rem] font-bold text-white\">\n                          ${product.price.toFixed(2)}\n                        </p>\n                        <span\n                          className={`rounded-full px-3 py-1 text-sm ${\n                            outOfStock\n                              ? \"bg-red-950/70 text-red-300\"\n                              : \"bg-emerald-950/70 text-emerald-300\"\n                          }`}\n                        >\n                          {outOfStock ? \"Out of stock\" : `${product.stock} in stock`}\n                        </span>\n                      </div>\n\n                      <button\n                        className=\"mt-4 w-full rounded-xl bg-[#4F7CFF] px-3 py-3 text-xl font-semibold text-white transition hover:bg-[#3f6ef2] disabled:cursor-not-allowed disabled:bg-zinc-700 disabled:text-zinc-400\"\n                        disabled={outOfStock || pending}\n                        onClick={() => void handleAddToCart(product.id)}\n                        type=\"button\"\n                      >\n                        {pending ? \"Adding...\" : \"Add to cart\"}\n                      </button>\n\n                      {feedback ? (\n                        <p\n                          className={`mt-2 text-sm ${\n                            feedback === \"Added to cart.\" ? \"text-[#30D158]\" : \"text-red-400\"\n                          }`}\n                        >\n                          {feedback}\n                        </p>\n                      ) : null}\n                    </div>\n                  </article>\n                );\n              })}\n            </div>\n          )}\n        </section>\n      </main>\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","ReactDOM","getImageProps","imgProps","props","getImgProps","defaultLoader","imgConf","process","env","__NEXT_IMAGE_OPTS","key","value","Object","entries","undefined","Image"],"mappings":"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","ignoreList":[0,1,2,3]}