{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ribhav/OneDrive/Documents/Projects/Major%20project%20final/localli/src/app/login/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport type { UserRole } from \"@/context/AuthContext\";\n\ntype LoginResponse = {\n  token: string;\n  message?: string;\n};\n\ntype MeResponse = {\n  user: {\n    role: UserRole;\n  };\n};\n\nasync function getRoleFromToken(token: string): Promise<UserRole> {\n  const meResponse = await fetch(\"/api/auth/me\", {\n    headers: {\n      Authorization: `Bearer ${token}`,\n    },\n  });\n\n  if (!meResponse.ok) {\n    throw new Error(\"Unable to resolve user role\");\n  }\n\n  const meData = (await meResponse.json()) as MeResponse;\n  if (\n    meData.user.role !== \"CUSTOMER\" &&\n    meData.user.role !== \"VENDOR\" &&\n    meData.user.role !== \"ADMIN\"\n  ) {\n    throw new Error(\"Invalid user role\");\n  }\n\n  return meData.user.role;\n}\n\nexport default function LoginPage() {\n  const router = useRouter();\n  const { login } = useAuth();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  async function handleSubmit(event: React.FormEvent<HTMLFormElement>) {\n    event.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(\"/api/auth/login\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ email, password }),\n      });\n\n      const data = (await response.json()) as LoginResponse;\n\n      if (!response.ok || !data.token) {\n        throw new Error(data.message ?? \"Unable to log in. Please try again.\");\n      }\n\n      const role = await getRoleFromToken(data.token);\n      login(data.token, role);\n\n      if (role === \"VENDOR\") {\n        router.replace(\"/vendor\");\n      } else if (role === \"ADMIN\") {\n        router.replace(\"/admin\");\n      } else {\n        router.replace(\"/\");\n      }\n    } catch (err) {\n      const message =\n        err instanceof Error ? err.message : \"Unable to log in. Please try again.\";\n      setError(message);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-black px-6 py-16\">\n      <div className=\"mx-auto max-w-7xl\">\n        <div className=\"mx-auto max-w-xl text-center\">\n          <h1 className=\"text-5xl font-bold tracking-tight text-white md:text-6xl\">Welcome Back</h1>\n          <p className=\"mt-3 text-xl text-zinc-400 md:text-2xl\">Sign in to your Localli account</p>\n        </div>\n\n        <div className=\"mx-auto mt-10 w-full max-w-[560px] rounded-3xl border border-zinc-800 bg-zinc-900/90 p-8 md:p-10\">\n          <form className=\"space-y-6\" onSubmit={handleSubmit}>\n            <div>\n              <label className=\"mb-2 block text-sm font-medium text-zinc-400\" htmlFor=\"email\">\n                Email\n              </label>\n              <input\n                className=\"w-full rounded-xl border border-zinc-800 bg-black px-5 py-4 text-2xl text-white outline-none ring-[#4F7CFF] placeholder:text-zinc-500 focus:ring-2\"\n                id=\"email\"\n                onChange={(event) => setEmail(event.target.value)}\n                required\n                type=\"email\"\n                value={email}\n              />\n            </div>\n\n            <div>\n              <label className=\"mb-2 block text-sm font-medium text-zinc-400\" htmlFor=\"password\">\n                Password\n              </label>\n              <input\n                className=\"w-full rounded-xl border border-zinc-800 bg-black px-5 py-4 text-2xl text-white outline-none ring-[#4F7CFF] placeholder:text-zinc-500 focus:ring-2\"\n                id=\"password\"\n                onChange={(event) => setPassword(event.target.value)}\n                required\n                type=\"password\"\n                value={password}\n              />\n            </div>\n\n            {error ? <p className=\"text-lg text-[#FF453A]\">{error}</p> : null}\n\n            <button\n              className=\"w-full rounded-xl bg-[#4F7CFF] px-5 py-4 text-3xl font-semibold text-white transition hover:bg-[#3f6ef2] disabled:cursor-not-allowed disabled:opacity-60\"\n              disabled={loading}\n              type=\"submit\"\n            >\n              {loading ? \"Signing in...\" : \"Sign In\"}\n            </button>\n          </form>\n\n          <p className=\"mt-6 text-center text-lg text-zinc-400\">\n            Don&apos;t have an account?{\" \"}\n            <a className=\"text-[#4F7CFF] transition hover:text-[#6A8CFF]\" href=\"/signup\">\n              Sign up\n            </a>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAkBA,eAAe,iBAAiB,KAAa;IAC3C,MAAM,aAAa,MAAM,MAAM,gBAAgB;QAC7C,SAAS;YACP,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;IACF;IAEA,IAAI,CAAC,WAAW,EAAE,EAAE;QAClB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,SAAU,MAAM,WAAW,IAAI;IACrC,IACE,OAAO,IAAI,CAAC,IAAI,KAAK,cACrB,OAAO,IAAI,CAAC,IAAI,KAAK,YACrB,OAAO,IAAI,CAAC,IAAI,KAAK,SACrB;QACA,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,OAAO,IAAI,CAAC,IAAI;AACzB;AAEe,SAAS;IACtB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,kIAAO;IACzB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD,eAAe,aAAa,KAAuC;QACjE,MAAM,cAAc;QACpB,WAAW;QACX,SAAS;QAET,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,mBAAmB;gBAC9C,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAO;gBAAS;YACzC;YAEA,MAAM,OAAQ,MAAM,SAAS,IAAI;YAEjC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,KAAK,EAAE;gBAC/B,MAAM,IAAI,MAAM,KAAK,OAAO,IAAI;YAClC;YAEA,MAAM,OAAO,MAAM,iBAAiB,KAAK,KAAK;YAC9C,MAAM,KAAK,KAAK,EAAE;YAElB,IAAI,SAAS,UAAU;gBACrB,OAAO,OAAO,CAAC;YACjB,OAAO,IAAI,SAAS,SAAS;gBAC3B,OAAO,OAAO,CAAC;YACjB,OAAO;gBACL,OAAO,OAAO,CAAC;YACjB;QACF,EAAE,OAAO,KAAK;YACZ,MAAM,UACJ,eAAe,QAAQ,IAAI,OAAO,GAAG;YACvC,SAAS;QACX,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAA2D;;;;;;sCACzE,8OAAC;4BAAE,WAAU;sCAAyC;;;;;;;;;;;;8BAGxD,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAK,WAAU;4BAAY,UAAU;;8CACpC,8OAAC;;sDACC,8OAAC;4CAAM,WAAU;4CAA+C,SAAQ;sDAAQ;;;;;;sDAGhF,8OAAC;4CACC,WAAU;4CACV,IAAG;4CACH,UAAU,CAAC,QAAU,SAAS,MAAM,MAAM,CAAC,KAAK;4CAChD,QAAQ;4CACR,MAAK;4CACL,OAAO;;;;;;;;;;;;8CAIX,8OAAC;;sDACC,8OAAC;4CAAM,WAAU;4CAA+C,SAAQ;sDAAW;;;;;;sDAGnF,8OAAC;4CACC,WAAU;4CACV,IAAG;4CACH,UAAU,CAAC,QAAU,YAAY,MAAM,MAAM,CAAC,KAAK;4CACnD,QAAQ;4CACR,MAAK;4CACL,OAAO;;;;;;;;;;;;gCAIV,sBAAQ,8OAAC;oCAAE,WAAU;8CAA0B;;;;;2CAAa;8CAE7D,8OAAC;oCACC,WAAU;oCACV,UAAU;oCACV,MAAK;8CAEJ,UAAU,kBAAkB;;;;;;;;;;;;sCAIjC,8OAAC;4BAAE,WAAU;;gCAAyC;gCACxB;8CAC5B,8OAAC;oCAAE,WAAU;oCAAiD,MAAK;8CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQzF"}}]
}