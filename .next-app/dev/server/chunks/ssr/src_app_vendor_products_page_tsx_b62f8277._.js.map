{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ribhav/OneDrive/Documents/Projects/Major%20project%20final/localli/src/app/vendor/products/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { FormEvent, useCallback, useEffect, useMemo, useState } from \"react\";\nimport { authFetch } from \"@/lib/authFetch\";\n\ntype Product = {\n  id: number;\n  name: string;\n  price: number;\n  stock: number;\n  storeId: number;\n};\n\ntype ProductsResponse = {\n  products?: Product[];\n  message?: string;\n};\n\ntype ProductResponse = {\n  product?: Product;\n  message?: string;\n};\n\nexport default function VendorProductsPage() {\n  const [products, setProducts] = useState<Product[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const [name, setName] = useState(\"\");\n  const [price, setPrice] = useState(\"\");\n  const [stock, setStock] = useState(\"\");\n  const [submitting, setSubmitting] = useState(false);\n  const [deletingIds, setDeletingIds] = useState<Set<number>>(new Set());\n  const [showAddForm, setShowAddForm] = useState(false);\n\n  const hasProducts = products.length > 0;\n\n  const formError = useMemo(() => {\n    const trimmedName = name.trim();\n    const parsedPrice = Number(price);\n    const parsedStock = Number(stock);\n\n    if (!trimmedName) {\n      return \"Product name is required.\";\n    }\n    if (!Number.isFinite(parsedPrice) || parsedPrice <= 0) {\n      return \"Price must be greater than 0.\";\n    }\n    if (!Number.isFinite(parsedStock) || parsedStock < 0 || !Number.isInteger(parsedStock)) {\n      return \"Stock must be a whole number 0 or greater.\";\n    }\n\n    return null;\n  }, [name, price, stock]);\n\n  const fetchProducts = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      const response = await authFetch(\"/api/vendor/products\");\n      const data = (await response.json()) as ProductsResponse;\n\n      if (!response.ok) {\n        throw new Error(data.message ?? \"Failed to load products.\");\n      }\n\n      setProducts(Array.isArray(data.products) ? data.products : []);\n    } catch (err) {\n      const message =\n        err instanceof Error ? err.message : \"Unable to load products right now.\";\n      setError(message);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    void fetchProducts();\n  }, [fetchProducts]);\n\n  async function handleCreateProduct(event: FormEvent<HTMLFormElement>) {\n    event.preventDefault();\n\n    if (formError) {\n      setError(formError);\n      return;\n    }\n\n    try {\n      setSubmitting(true);\n      setError(null);\n\n      const response = await authFetch(\"/api/vendor/products\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          name: name.trim(),\n          price: Number(price),\n          stock: Number(stock),\n        }),\n      });\n\n      const data = (await response.json()) as ProductResponse;\n\n      if (!response.ok) {\n        throw new Error(data.message ?? \"Failed to create product.\");\n      }\n\n      setName(\"\");\n      setPrice(\"\");\n      setStock(\"\");\n      await fetchProducts();\n    } catch (err) {\n      const message =\n        err instanceof Error ? err.message : \"Unable to create product right now.\";\n      setError(message);\n    } finally {\n      setSubmitting(false);\n    }\n  }\n\n  async function handleDeleteProduct(productId: number) {\n    try {\n      setDeletingIds((prev) => {\n        const next = new Set(prev);\n        next.add(productId);\n        return next;\n      });\n\n      setError(null);\n\n      const response = await authFetch(`/api/vendor/products/${productId}`, {\n        method: \"DELETE\",\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.message ?? \"Failed to delete product.\");\n      }\n\n      await fetchProducts();\n    } catch (err) {\n      const message =\n        err instanceof Error ? err.message : \"Unable to delete product right now.\";\n      setError(message);\n    } finally {\n      setDeletingIds((prev) => {\n        const next = new Set(prev);\n        next.delete(productId);\n        return next;\n      });\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <h1 className=\"text-5xl font-bold tracking-tight md:text-6xl\">Products</h1>\n        <button\n          className=\"rounded-2xl bg-[#4F7CFF] px-6 py-3 text-2xl font-semibold text-white transition hover:bg-[#3f6ef2]\"\n          onClick={() => setShowAddForm((prev) => !prev)}\n          type=\"button\"\n        >\n          + Add Product\n        </button>\n      </div>\n\n      {showAddForm ? (\n        <section className=\"rounded-2xl border border-zinc-800 bg-zinc-900/90 p-6\">\n          <h2 className=\"text-3xl font-semibold\">Add Product</h2>\n          <form className=\"mt-5 grid grid-cols-1 gap-4 md:grid-cols-4\" onSubmit={handleCreateProduct}>\n            <div className=\"md:col-span-2\">\n              <label className=\"mb-1 block text-lg text-zinc-300\" htmlFor=\"product-name\">\n                Name\n              </label>\n              <input\n                className=\"w-full rounded-xl border border-zinc-700 bg-black px-4 py-3 text-xl text-white outline-none ring-[#4F7CFF] focus:ring-2\"\n                id=\"product-name\"\n                onChange={(event) => setName(event.target.value)}\n                placeholder=\"Fresh Organic Avocados\"\n                required\n                type=\"text\"\n                value={name}\n              />\n            </div>\n            <div>\n              <label className=\"mb-1 block text-lg text-zinc-300\" htmlFor=\"product-price\">\n                Price\n              </label>\n              <input\n                className=\"w-full rounded-xl border border-zinc-700 bg-black px-4 py-3 text-xl text-white outline-none ring-[#4F7CFF] focus:ring-2\"\n                id=\"product-price\"\n                min=\"0.01\"\n                onChange={(event) => setPrice(event.target.value)}\n                required\n                step=\"0.01\"\n                type=\"number\"\n                value={price}\n              />\n            </div>\n            <div>\n              <label className=\"mb-1 block text-lg text-zinc-300\" htmlFor=\"product-stock\">\n                Stock\n              </label>\n              <input\n                className=\"w-full rounded-xl border border-zinc-700 bg-black px-4 py-3 text-xl text-white outline-none ring-[#4F7CFF] focus:ring-2\"\n                id=\"product-stock\"\n                min=\"0\"\n                onChange={(event) => setStock(event.target.value)}\n                required\n                step=\"1\"\n                type=\"number\"\n                value={stock}\n              />\n            </div>\n            <div className=\"md:col-span-4\">\n              <button\n                className=\"rounded-xl bg-[#4F7CFF] px-5 py-3 text-xl font-semibold text-white transition hover:bg-[#3f6ef2] disabled:opacity-60\"\n                disabled={submitting}\n                type=\"submit\"\n              >\n                {submitting ? \"Adding Product...\" : \"Save Product\"}\n              </button>\n            </div>\n          </form>\n        </section>\n      ) : null}\n\n      <section className=\"overflow-hidden rounded-3xl border border-zinc-800 bg-zinc-900/90\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full text-xl\">\n            <thead>\n              <tr className=\"border-b border-zinc-800 text-zinc-400\">\n                <th className=\"px-7 py-5 text-left font-medium\">Product</th>\n                <th className=\"px-7 py-5 text-left font-medium\">Category</th>\n                <th className=\"px-7 py-5 text-left font-medium\">Price</th>\n                <th className=\"px-7 py-5 text-left font-medium\">Stock</th>\n                <th className=\"px-7 py-5 text-left font-medium\">Status</th>\n                <th className=\"px-7 py-5 text-right font-medium\">Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {loading ? (\n                <tr>\n                  <td className=\"px-7 py-6 text-zinc-300\" colSpan={6}>\n                    Loading products...\n                  </td>\n                </tr>\n              ) : !hasProducts ? (\n                <tr>\n                  <td className=\"px-7 py-6 text-zinc-400\" colSpan={6}>\n                    No products yet.\n                  </td>\n                </tr>\n              ) : (\n                products.map((product) => {\n                  const isDeleting = deletingIds.has(product.id);\n                  const lowStock = product.stock < 20;\n                  const category = deriveCategory(product.name);\n\n                  return (\n                    <tr className=\"border-b border-zinc-800/70\" key={product.id}>\n                      <td className=\"px-7 py-6\">\n                        <div className=\"flex items-center gap-4\">\n                          <span className=\"inline-flex h-12 w-12 items-center justify-center rounded-xl bg-zinc-800 text-blue-400\">\n                            <svg aria-hidden=\"true\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\">\n                              <path d=\"M12 3L20 7.5V16.5L12 21L4 16.5V7.5L12 3Z\" stroke=\"currentColor\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" />\n                              <path d=\"M12 12L20 7.5\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n                              <path d=\"M12 12L4 7.5\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n                              <path d=\"M12 12V21\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n                            </svg>\n                          </span>\n                          <span className=\"font-semibold text-zinc-100\">{product.name}</span>\n                        </div>\n                      </td>\n                      <td className=\"px-7 py-6 text-zinc-400\">{category}</td>\n                      <td className=\"px-7 py-6 font-semibold text-zinc-100\">\n                        ${product.price.toFixed(2)}\n                      </td>\n                      <td className=\"px-7 py-6 text-zinc-100\">{product.stock}</td>\n                      <td className=\"px-7 py-6\">\n                        <span\n                          className={`rounded-xl px-3 py-1 text-lg ${\n                            lowStock ? \"bg-amber-950/60 text-amber-300\" : \"bg-emerald-950/60 text-emerald-300\"\n                          }`}\n                        >\n                          {lowStock ? \"Low Stock\" : \"In Stock\"}\n                        </span>\n                      </td>\n                      <td className=\"px-7 py-6 text-right\">\n                        <button\n                          className=\"rounded-lg px-3 py-1.5 text-lg text-blue-400 transition hover:bg-zinc-800\"\n                          type=\"button\"\n                        >\n                          âœŽ\n                        </button>\n                        <button\n                          className=\"rounded-lg px-3 py-1.5 text-lg text-red-400 transition hover:bg-zinc-800 disabled:opacity-50\"\n                          disabled={isDeleting}\n                          onClick={() => void handleDeleteProduct(product.id)}\n                          type=\"button\"\n                        >\n                          {isDeleting ? \"...\" : \"ðŸ—‘\"}\n                        </button>\n                      </td>\n                    </tr>\n                  );\n                })\n              )}\n            </tbody>\n          </table>\n        </div>\n      </section>\n\n      {error ? (\n        <div className=\"rounded-xl border border-red-900/40 bg-red-950/20 p-4 text-red-300\">{error}</div>\n      ) : null}\n    </div>\n  );\n}\n\nfunction deriveCategory(name: string): string {\n  const value = name.toLowerCase();\n  if (value.includes(\"bread\")) return \"Bakery\";\n  if (value.includes(\"egg\") || value.includes(\"milk\")) return \"Dairy\";\n  if (value.includes(\"coffee\") || value.includes(\"drink\")) return \"Beverages\";\n  return \"Produce\";\n}\n"],"names":[],"mappings":"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"}}]
}