{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ribhav/OneDrive/Documents/Projects/Major%20project%20final/localli/src/context/AuthContext.tsx"],"sourcesContent":["\"use client\";\n\nimport { createContext, useEffect, useMemo, useState, type ReactNode } from \"react\";\n\nexport type UserRole = \"CUSTOMER\" | \"VENDOR\" | \"ADMIN\";\n\ntype AuthContextValue = {\n  userRole: UserRole | null;\n  token: string | null;\n  loading: boolean;\n  login: (nextToken: string, nextRole: UserRole) => void;\n  logout: () => void;\n};\n\nexport const AuthContext = createContext<AuthContextValue | null>(null);\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nconst TOKEN_KEY = \"auth_token\";\nconst ROLE_KEY = \"auth_role\";\n\nexport function AuthProvider({ children }: AuthProviderProps) {\n  const [userRole, setUserRole] = useState<UserRole | null>(null);\n  const [token, setToken] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    try {\n      const storedToken = localStorage.getItem(TOKEN_KEY);\n      const storedRole = localStorage.getItem(ROLE_KEY);\n\n      const validRole =\n        storedRole === \"CUSTOMER\" || storedRole === \"VENDOR\" || storedRole === \"ADMIN\"\n          ? storedRole\n          : null;\n\n      setToken(storedToken);\n      setUserRole(validRole);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const value = useMemo<AuthContextValue>(\n    () => ({\n      userRole,\n      token,\n      loading,\n      login: (nextToken, nextRole) => {\n        localStorage.setItem(TOKEN_KEY, nextToken);\n        localStorage.setItem(ROLE_KEY, nextRole);\n        setToken(nextToken);\n        setUserRole(nextRole);\n      },\n      logout: () => {\n        localStorage.removeItem(TOKEN_KEY);\n        localStorage.removeItem(ROLE_KEY);\n        setToken(null);\n        setUserRole(null);\n      },\n    }),\n    [loading, token, userRole]\n  );\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAcO,MAAM,4BAAc,IAAA,sNAAa,EAA0B;AAMlE,MAAM,YAAY;AAClB,MAAM,WAAW;AAEV,SAAS,aAAa,EAAE,QAAQ,EAAqB;IAC1D,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAkB;IAC1D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,IAAI;YACF,MAAM,cAAc,aAAa,OAAO,CAAC;YACzC,MAAM,aAAa,aAAa,OAAO,CAAC;YAExC,MAAM,YACJ,eAAe,cAAc,eAAe,YAAY,eAAe,UACnE,aACA;YAEN,SAAS;YACT,YAAY;QACd,SAAU;YACR,WAAW;QACb;IACF,GAAG,EAAE;IAEL,MAAM,QAAQ,IAAA,gNAAO,EACnB,IAAM,CAAC;YACL;YACA;YACA;YACA,OAAO,CAAC,WAAW;gBACjB,aAAa,OAAO,CAAC,WAAW;gBAChC,aAAa,OAAO,CAAC,UAAU;gBAC/B,SAAS;gBACT,YAAY;YACd;YACA,QAAQ;gBACN,aAAa,UAAU,CAAC;gBACxB,aAAa,UAAU,CAAC;gBACxB,SAAS;gBACT,YAAY;YACd;QACF,CAAC,GACD;QAAC;QAAS;QAAO;KAAS;IAG5B,qBAAO,8OAAC,YAAY,QAAQ;QAAC,OAAO;kBAAQ;;;;;;AAC9C"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ribhav/OneDrive/Documents/Projects/Major%20project%20final/localli/src/hooks/useAuth.ts"],"sourcesContent":["\"use client\";\n\nimport { useContext } from \"react\";\nimport { AuthContext } from \"@/context/AuthContext\";\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n\n  return context;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKO,SAAS;IACd,MAAM,UAAU,IAAA,mNAAU,EAAC,6IAAW;IACtC,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ribhav/OneDrive/Documents/Projects/Major%20project%20final/localli/src/lib/authFetch.ts"],"sourcesContent":["export async function authFetch(input: RequestInfo | URL, init: RequestInit = {}) {\n  if (typeof window === \"undefined\") {\n    throw new Error(\"authFetch can only be used in the browser\");\n  }\n\n  const token = localStorage.getItem(\"auth_token\");\n  if (!token) {\n    throw new Error(\"Authentication token is missing\");\n  }\n\n  const headers = new Headers(init.headers);\n  headers.set(\"Authorization\", `Bearer ${token}`);\n\n  return fetch(input, {\n    ...init,\n    headers,\n  });\n}\n"],"names":[],"mappings":";;;;AAAO,eAAe,UAAU,KAAwB,EAAE,OAAoB,CAAC,CAAC;IAC9E,wCAAmC;QACjC,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,UAAU,IAAI,QAAQ,KAAK,OAAO;IACxC,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;IAE9C,OAAO,MAAM,OAAO;QAClB,GAAG,IAAI;QACP;IACF;AACF"}},
    {"offset": {"line": 134, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ribhav/OneDrive/Documents/Projects/Major%20project%20final/localli/src/components/layout/AppNavbar.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { useEffect, useMemo, useState, type ReactNode } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { authFetch } from \"@/lib/authFetch\";\n\ntype NavItem = {\n  label: string;\n  href: string;\n  icon?: ReactNode;\n};\n\nconst guestNav: NavItem[] = [{ label: \"Home\", href: \"/\" }];\nconst customerNav: NavItem[] = [\n  { label: \"Home\", href: \"/\" },\n  { label: \"Cart\", href: \"/cart\", icon: <span className=\"text-base\">ðŸ›’</span> },\n  { label: \"Orders\", href: \"/orders\" },\n];\nconst vendorNav: NavItem[] = [\n  { label: \"Dashboard\", href: \"/vendor\", icon: <GridIcon /> },\n  { label: \"Products\", href: \"/vendor/products\", icon: <CubeIcon /> },\n  { label: \"Orders\", href: \"/vendor/orders\" },\n  { label: \"Analytics\", href: \"/vendor/analytics\", icon: <BarsIcon /> },\n];\nconst adminNav: NavItem[] = [\n  { label: \"Dashboard\", href: \"/admin\" },\n  { label: \"Clusters\", href: \"/admin/clusters\" },\n  { label: \"Heatmap\", href: \"/admin/heatmap\" },\n  { label: \"Logs\", href: \"/admin/logs\" },\n];\n\nexport default function AppNavbar() {\n  const router = useRouter();\n  const pathname = usePathname();\n  const { token, userRole, logout, loading } = useAuth();\n  const [cartCount, setCartCount] = useState(0);\n\n  const isAuthed = Boolean(token) && !loading;\n  const navItems = useMemo(\n    () =>\n      !isAuthed\n        ? guestNav\n        : userRole === \"VENDOR\"\n          ? vendorNav\n          : userRole === \"ADMIN\"\n            ? adminNav\n            : customerNav,\n    [isAuthed, userRole]\n  );\n\n  useEffect(() => {\n    if (!isAuthed || userRole !== \"CUSTOMER\") {\n      return;\n    }\n\n    let active = true;\n\n    async function fetchCartCount() {\n      try {\n        const response = await authFetch(\"/api/cart\");\n        if (!response.ok) {\n          return;\n        }\n\n        const data = (await response.json()) as Array<{ quantity: number }>;\n        if (!active || !Array.isArray(data)) {\n          return;\n        }\n\n        const count = data.reduce((sum, item) => sum + (item.quantity ?? 0), 0);\n        setCartCount(count);\n      } catch {\n        if (active) {\n          setCartCount(0);\n        }\n      }\n    }\n\n    void fetchCartCount();\n\n    return () => {\n      active = false;\n    };\n  }, [isAuthed, pathname, userRole]);\n\n  const visibleCartCount = isAuthed && userRole === \"CUSTOMER\" ? cartCount : 0;\n\n  function handleLogout() {\n    logout();\n    router.push(\"/login\");\n  }\n\n  if (pathname.startsWith(\"/admin\")) {\n    return null;\n  }\n\n  return (\n    <header className=\"sticky top-0 z-40 border-b border-zinc-800 bg-black/95 backdrop-blur\">\n      <div className=\"mx-auto flex w-full max-w-[1600px] flex-wrap items-center justify-between gap-3 px-6 py-4\">\n        <Link className=\"text-lg font-semibold text-white\" href=\"/\">\n          Localli\n        </Link>\n\n        <nav className=\"flex flex-wrap items-center gap-2\">\n          {navItems.map((item) => (\n            <Link\n              className={`relative rounded-lg px-3 py-1.5 text-sm transition ${\n                pathname === item.href ? \"text-white\" : \"text-zinc-300 hover:text-white\"\n              }`}\n              href={item.href}\n              key={item.href}\n            >\n              {item.icon ? <span className=\"mr-1 inline-flex\">{item.icon}</span> : null}\n              {item.label}\n              {item.label === \"Cart\" && visibleCartCount > 0 ? (\n                <span className=\"absolute -right-1 -top-1 inline-flex h-5 min-w-5 items-center justify-center rounded-full bg-[#4F7CFF] px-1 text-xs font-semibold text-white\">\n                  {visibleCartCount}\n                </span>\n              ) : null}\n            </Link>\n          ))}\n\n          {!isAuthed ? (\n            <>\n              <Link\n                className=\"rounded-lg px-3 py-1.5 text-sm text-zinc-300 transition hover:bg-zinc-900 hover:text-white\"\n                href=\"/login\"\n              >\n                Login\n              </Link>\n              <Link\n                className=\"rounded-lg bg-[#4F7CFF] px-3 py-1.5 text-sm font-medium text-white transition hover:bg-[#3f6ef2]\"\n                href=\"/signup\"\n              >\n                Signup\n              </Link>\n            </>\n          ) : (\n            <>\n              <button\n                aria-label=\"Logout\"\n                className=\"ml-2 inline-flex h-10 w-10 items-center justify-center rounded-full bg-[#6366F1] text-sm font-semibold uppercase text-white transition hover:brightness-110\"\n                onClick={handleLogout}\n                title=\"Logout\"\n                type=\"button\"\n              >\n                {userRole?.slice(0, 1)}\n              </button>\n            </>\n          )}\n        </nav>\n      </div>\n    </header>\n  );\n}\n\nfunction GridIcon() {\n  return (\n    <svg aria-hidden=\"true\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\n      <rect height=\"7\" rx=\"1.5\" stroke=\"currentColor\" width=\"7\" x=\"3\" y=\"3\" />\n      <rect height=\"7\" rx=\"1.5\" stroke=\"currentColor\" width=\"7\" x=\"14\" y=\"3\" />\n      <rect height=\"7\" rx=\"1.5\" stroke=\"currentColor\" width=\"7\" x=\"3\" y=\"14\" />\n      <rect height=\"7\" rx=\"1.5\" stroke=\"currentColor\" width=\"7\" x=\"14\" y=\"14\" />\n    </svg>\n  );\n}\n\nfunction CubeIcon() {\n  return (\n    <svg aria-hidden=\"true\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\n      <path d=\"M12 3L20 7.5V16.5L12 21L4 16.5V7.5L12 3Z\" stroke=\"currentColor\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" />\n      <path d=\"M12 12L20 7.5\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n      <path d=\"M12 12L4 7.5\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n      <path d=\"M12 12V21\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n    </svg>\n  );\n}\n\nfunction BarsIcon() {\n  return (\n    <svg aria-hidden=\"true\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\n      <path d=\"M4 20V10\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeWidth=\"1.5\" />\n      <path d=\"M10 20V4\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeWidth=\"1.5\" />\n      <path d=\"M16 20V14\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeWidth=\"1.5\" />\n      <path d=\"M22 20V7\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeWidth=\"1.5\" />\n    </svg>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}