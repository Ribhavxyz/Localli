{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ribhav/OneDrive/Documents/Projects/Major%20project%20final/localli/src/app/orders/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { authFetch } from \"@/lib/authFetch\";\n\ntype OrderItem = {\n  id: number;\n  productId: number;\n  quantity: number;\n  price: number;\n};\n\ntype Order = {\n  id: number;\n  total: number;\n  status: string;\n  createdAt: string;\n  items?: OrderItem[];\n  orderItems?: OrderItem[];\n};\n\ntype ApiError = {\n  message?: string;\n};\n\nfunction formatOrderNumber(id: number): string {\n  return `ORD-${String(id + 1000).padStart(4, \"0\")}`;\n}\n\nfunction formatOrderDate(value: string): string {\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) {\n    return \"Unknown date\";\n  }\n\n  return date.toLocaleDateString(\"en-US\", {\n    month: \"short\",\n    day: \"numeric\",\n    year: \"numeric\",\n  });\n}\n\nfunction getStatusStyle(status: string): string {\n  const normalized = status.toLowerCase();\n  if (normalized.includes(\"delivered\")) {\n    return \"bg-emerald-950/60 text-emerald-300\";\n  }\n  if (normalized.includes(\"transit\") || normalized.includes(\"shipped\")) {\n    return \"bg-blue-950/60 text-blue-300\";\n  }\n  if (normalized.includes(\"process\") || normalized.includes(\"placed\")) {\n    return \"bg-amber-950/60 text-amber-300\";\n  }\n  return \"bg-zinc-800 text-zinc-300\";\n}\n\nexport default function OrdersPage() {\n  const [orders, setOrders] = useState<Order[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [expandedOrderIds, setExpandedOrderIds] = useState<Set<number>>(new Set());\n\n  useEffect(() => {\n    let active = true;\n\n    async function fetchOrders() {\n      try {\n        setLoading(true);\n        setError(null);\n\n        const response = await authFetch(\"/api/orders\");\n        const data = (await response.json()) as Order[] | ApiError;\n\n        if (!response.ok) {\n          throw new Error(!Array.isArray(data) ? data.message ?? \"Failed to fetch orders.\" : \"Failed to fetch orders.\");\n        }\n\n        if (!active) {\n          return;\n        }\n\n        setOrders(Array.isArray(data) ? data : []);\n      } catch (err) {\n        if (!active) {\n          return;\n        }\n\n        const message = err instanceof Error ? err.message : \"Unable to load orders right now.\";\n        setError(message);\n      } finally {\n        if (active) {\n          setLoading(false);\n        }\n      }\n    }\n\n    void fetchOrders();\n\n    return () => {\n      active = false;\n    };\n  }, []);\n\n  const normalizedOrders = useMemo(\n    () =>\n      orders.map((order) => ({\n        ...order,\n        items: order.items ?? order.orderItems ?? [],\n      })),\n    [orders]\n  );\n\n  function toggleDetails(orderId: number) {\n    setExpandedOrderIds((prev) => {\n      const next = new Set(prev);\n      if (next.has(orderId)) {\n        next.delete(orderId);\n      } else {\n        next.add(orderId);\n      }\n      return next;\n    });\n  }\n\n  return (\n    <div className=\"min-h-screen bg-black px-6 py-16 text-white\">\n      <div className=\"mx-auto max-w-7xl\">\n        <h1 className=\"mb-8 text-5xl font-bold tracking-tight\">My Orders</h1>\n\n        {loading ? (\n          <div className=\"rounded-2xl border border-zinc-800 bg-zinc-900/80 p-8 text-center text-zinc-300\">\n            Loading orders...\n          </div>\n        ) : error ? (\n          <div className=\"rounded-2xl border border-red-900/40 bg-red-950/20 p-6 text-red-300\">\n            {error}\n          </div>\n        ) : normalizedOrders.length === 0 ? (\n          <div className=\"rounded-2xl border border-dashed border-zinc-700 bg-zinc-900/80 p-10 text-center text-zinc-400\">\n            You have no orders yet.\n          </div>\n        ) : (\n          <div className=\"space-y-5\">\n            {normalizedOrders.map((order) => {\n              const isExpanded = expandedOrderIds.has(order.id);\n              const items = order.items ?? [];\n\n              return (\n                <article\n                  className=\"rounded-2xl border border-zinc-800 bg-zinc-900/90 p-6\"\n                  key={order.id}\n                >\n                  <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                    <div>\n                      <p className=\"text-3xl font-semibold text-zinc-100\">\n                        {formatOrderNumber(order.id)}\n                      </p>\n                      <p className=\"mt-1 text-xl text-zinc-400\">{formatOrderDate(order.createdAt)}</p>\n                    </div>\n                    <span\n                      className={`rounded-xl px-4 py-2 text-lg font-medium ${getStatusStyle(order.status)}`}\n                    >\n                      {order.status}\n                    </span>\n                  </div>\n\n                  <div className=\"mt-6 h-px bg-zinc-800\" />\n\n                  <div className=\"mt-5 flex flex-wrap items-center justify-between gap-4\">\n                    <div className=\"flex items-center gap-10\">\n                      <div>\n                        <p className=\"text-base text-zinc-400\">Items</p>\n                        <p className=\"text-3xl font-semibold text-zinc-100\">{items.length}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-base text-zinc-400\">Total</p>\n                        <p className=\"text-3xl font-semibold text-zinc-100\">\n                          ${order.total.toFixed(2)}\n                        </p>\n                      </div>\n                    </div>\n                    <button\n                      className=\"rounded-xl bg-zinc-800 px-5 py-2.5 text-lg font-semibold text-zinc-100 transition hover:bg-zinc-700\"\n                      onClick={() => toggleDetails(order.id)}\n                      type=\"button\"\n                    >\n                      {isExpanded ? \"Hide Details\" : \"View Details\"}\n                    </button>\n                  </div>\n\n                  {isExpanded ? (\n                    <div className=\"mt-5 rounded-xl border border-zinc-800 bg-black/40 p-4\">\n                      {items.length === 0 ? (\n                        <p className=\"text-sm text-zinc-400\">No item details available.</p>\n                      ) : (\n                        <ul className=\"space-y-3\">\n                          {items.map((item) => (\n                            <li\n                              className=\"flex items-center justify-between rounded-lg border border-zinc-800 bg-zinc-900/60 px-4 py-3\"\n                              key={item.id}\n                            >\n                              <div>\n                                <p className=\"text-base font-medium text-zinc-100\">\n                                  Product #{item.productId}\n                                </p>\n                                <p className=\"text-sm text-zinc-400\">Qty: {item.quantity}</p>\n                              </div>\n                              <p className=\"text-base font-semibold text-zinc-100\">\n                                ${(item.price * item.quantity).toFixed(2)}\n                              </p>\n                            </li>\n                          ))}\n                        </ul>\n                      )}\n                    </div>\n                  ) : null}\n                </article>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}