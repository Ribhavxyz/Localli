{"version":3,"sources":["../../../../src/app/admin/logs/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\n\ntype Cluster = {\n  clusterId: string;\n  currentDemandScore: number;\n  previousDemandScore: number;\n  growthRate: number;\n  isSurging: boolean;\n  competitionIndex: number;\n  opportunityScore: number;\n  latitude: number;\n  longitude: number;\n};\n\ntype LogEntry = {\n  id: string;\n  timestamp: string;\n  level: \"info\" | \"warning\" | \"success\";\n  message: string;\n};\n\nexport default function AdminLogsPage() {\n  const [clusters, setClusters] = useState<Cluster[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    let active = true;\n\n    async function loadData() {\n      try {\n        setLoading(true);\n        setError(null);\n        const response = await fetch(\"/api/analytics/cluster-intelligence?days=7\");\n        if (!response.ok) {\n          throw new Error(\"Failed to load logs data\");\n        }\n        const data = (await response.json()) as { clusters?: Cluster[] };\n        if (!active) {\n          return;\n        }\n        setClusters(Array.isArray(data.clusters) ? data.clusters : []);\n      } catch (err) {\n        if (!active) {\n          return;\n        }\n        setError(err instanceof Error ? err.message : \"Unable to load logs\");\n      } finally {\n        if (active) {\n          setLoading(false);\n        }\n      }\n    }\n\n    void loadData();\n    return () => {\n      active = false;\n    };\n  }, []);\n\n  const logs = useMemo<LogEntry[]>(() => {\n    const now = new Date();\n    const entries: LogEntry[] = [];\n\n    for (const cluster of clusters) {\n      if (cluster.isSurging) {\n        entries.push({\n          id: `surge-${cluster.clusterId}`,\n          timestamp: now.toISOString(),\n          level: \"success\",\n          message: `Cluster ${cluster.clusterId} marked as surging (${cluster.growthRate.toFixed(\n            1\n          )}% growth).`,\n        });\n      }\n\n      if (cluster.competitionIndex >= 6) {\n        entries.push({\n          id: `comp-${cluster.clusterId}`,\n          timestamp: now.toISOString(),\n          level: \"warning\",\n          message: `Cluster ${cluster.clusterId} high competition index ${cluster.competitionIndex.toFixed(\n            2\n          )}.`,\n        });\n      }\n\n      if (!cluster.isSurging && cluster.growthRate < 0) {\n        entries.push({\n          id: `drop-${cluster.clusterId}`,\n          timestamp: now.toISOString(),\n          level: \"info\",\n          message: `Cluster ${cluster.clusterId} demand declined by ${Math.abs(\n            cluster.growthRate\n          ).toFixed(1)}%.`,\n        });\n      }\n    }\n\n    return entries.slice(0, 25);\n  }, [clusters]);\n\n  return (\n    <div className=\"space-y-6\">\n      <h1 className=\"text-5xl font-bold tracking-tight md:text-6xl\">Logs</h1>\n\n      {loading ? (\n        <div className=\"rounded-2xl border border-zinc-800 bg-zinc-900/80 p-8 text-zinc-300\">\n          Loading logs...\n        </div>\n      ) : error ? (\n        <div className=\"rounded-2xl border border-red-900/40 bg-red-950/20 p-6 text-red-300\">\n          {error}\n        </div>\n      ) : (\n        <section className=\"space-y-3\">\n          {logs.length === 0 ? (\n            <div className=\"rounded-2xl border border-zinc-800 bg-zinc-900/90 p-6 text-zinc-400\">\n              No recent events.\n            </div>\n          ) : (\n            logs.map((log) => (\n              <article\n                className=\"rounded-xl border border-zinc-800 bg-zinc-900/90 p-4\"\n                key={log.id}\n              >\n                <div className=\"flex flex-wrap items-center justify-between gap-2\">\n                  <span\n                    className={`rounded-md px-2 py-1 text-xs uppercase tracking-wide ${\n                      log.level === \"success\"\n                        ? \"bg-emerald-950/60 text-emerald-300\"\n                        : log.level === \"warning\"\n                          ? \"bg-amber-950/60 text-amber-300\"\n                          : \"bg-blue-950/60 text-blue-300\"\n                    }`}\n                  >\n                    {log.level}\n                  </span>\n                  <span className=\"text-xs text-zinc-500\">\n                    {new Date(log.timestamp).toLocaleString()}\n                  </span>\n                </div>\n                <p className=\"mt-2 text-sm text-zinc-200\">{log.message}</p>\n              </article>\n            ))\n          )}\n        </section>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}