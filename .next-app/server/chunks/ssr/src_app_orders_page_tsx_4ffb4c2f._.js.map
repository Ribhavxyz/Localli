{"version":3,"sources":["../../../../src/app/orders/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { authFetch } from \"@/lib/authFetch\";\n\ntype OrderItem = {\n  id: number;\n  productId: number;\n  quantity: number;\n  price: number;\n};\n\ntype Order = {\n  id: number;\n  total: number;\n  status: string;\n  createdAt: string;\n  items?: OrderItem[];\n  orderItems?: OrderItem[];\n};\n\ntype ApiError = {\n  message?: string;\n};\n\nfunction formatOrderNumber(id: number): string {\n  return `ORD-${String(id + 1000).padStart(4, \"0\")}`;\n}\n\nfunction formatOrderDate(value: string): string {\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) {\n    return \"Unknown date\";\n  }\n\n  return date.toLocaleDateString(\"en-US\", {\n    month: \"short\",\n    day: \"numeric\",\n    year: \"numeric\",\n  });\n}\n\nfunction getStatusStyle(status: string): string {\n  const normalized = status.toLowerCase();\n  if (normalized.includes(\"delivered\")) {\n    return \"bg-emerald-950/60 text-emerald-300\";\n  }\n  if (normalized.includes(\"transit\") || normalized.includes(\"shipped\")) {\n    return \"bg-blue-950/60 text-blue-300\";\n  }\n  if (normalized.includes(\"process\") || normalized.includes(\"placed\")) {\n    return \"bg-amber-950/60 text-amber-300\";\n  }\n  return \"bg-zinc-800 text-zinc-300\";\n}\n\nexport default function OrdersPage() {\n  const [orders, setOrders] = useState<Order[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [expandedOrderIds, setExpandedOrderIds] = useState<Set<number>>(new Set());\n\n  useEffect(() => {\n    let active = true;\n\n    async function fetchOrders() {\n      try {\n        setLoading(true);\n        setError(null);\n\n        const response = await authFetch(\"/api/orders\");\n        const data = (await response.json()) as Order[] | ApiError;\n\n        if (!response.ok) {\n          throw new Error(!Array.isArray(data) ? data.message ?? \"Failed to fetch orders.\" : \"Failed to fetch orders.\");\n        }\n\n        if (!active) {\n          return;\n        }\n\n        setOrders(Array.isArray(data) ? data : []);\n      } catch (err) {\n        if (!active) {\n          return;\n        }\n\n        const message = err instanceof Error ? err.message : \"Unable to load orders right now.\";\n        setError(message);\n      } finally {\n        if (active) {\n          setLoading(false);\n        }\n      }\n    }\n\n    void fetchOrders();\n\n    return () => {\n      active = false;\n    };\n  }, []);\n\n  const normalizedOrders = useMemo(\n    () =>\n      orders.map((order) => ({\n        ...order,\n        items: order.items ?? order.orderItems ?? [],\n      })),\n    [orders]\n  );\n\n  function toggleDetails(orderId: number) {\n    setExpandedOrderIds((prev) => {\n      const next = new Set(prev);\n      if (next.has(orderId)) {\n        next.delete(orderId);\n      } else {\n        next.add(orderId);\n      }\n      return next;\n    });\n  }\n\n  return (\n    <div className=\"min-h-screen bg-black px-6 py-16 text-white\">\n      <div className=\"mx-auto max-w-7xl\">\n        <h1 className=\"mb-8 text-5xl font-bold tracking-tight\">My Orders</h1>\n\n        {loading ? (\n          <div className=\"rounded-2xl border border-zinc-800 bg-zinc-900/80 p-8 text-center text-zinc-300\">\n            Loading orders...\n          </div>\n        ) : error ? (\n          <div className=\"rounded-2xl border border-red-900/40 bg-red-950/20 p-6 text-red-300\">\n            {error}\n          </div>\n        ) : normalizedOrders.length === 0 ? (\n          <div className=\"rounded-2xl border border-dashed border-zinc-700 bg-zinc-900/80 p-10 text-center text-zinc-400\">\n            You have no orders yet.\n          </div>\n        ) : (\n          <div className=\"space-y-5\">\n            {normalizedOrders.map((order) => {\n              const isExpanded = expandedOrderIds.has(order.id);\n              const items = order.items ?? [];\n\n              return (\n                <article\n                  className=\"rounded-2xl border border-zinc-800 bg-zinc-900/90 p-6\"\n                  key={order.id}\n                >\n                  <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                    <div>\n                      <p className=\"text-3xl font-semibold text-zinc-100\">\n                        {formatOrderNumber(order.id)}\n                      </p>\n                      <p className=\"mt-1 text-xl text-zinc-400\">{formatOrderDate(order.createdAt)}</p>\n                    </div>\n                    <span\n                      className={`rounded-xl px-4 py-2 text-lg font-medium ${getStatusStyle(order.status)}`}\n                    >\n                      {order.status}\n                    </span>\n                  </div>\n\n                  <div className=\"mt-6 h-px bg-zinc-800\" />\n\n                  <div className=\"mt-5 flex flex-wrap items-center justify-between gap-4\">\n                    <div className=\"flex items-center gap-10\">\n                      <div>\n                        <p className=\"text-base text-zinc-400\">Items</p>\n                        <p className=\"text-3xl font-semibold text-zinc-100\">{items.length}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-base text-zinc-400\">Total</p>\n                        <p className=\"text-3xl font-semibold text-zinc-100\">\n                          ${order.total.toFixed(2)}\n                        </p>\n                      </div>\n                    </div>\n                    <button\n                      className=\"rounded-xl bg-zinc-800 px-5 py-2.5 text-lg font-semibold text-zinc-100 transition hover:bg-zinc-700\"\n                      onClick={() => toggleDetails(order.id)}\n                      type=\"button\"\n                    >\n                      {isExpanded ? \"Hide Details\" : \"View Details\"}\n                    </button>\n                  </div>\n\n                  {isExpanded ? (\n                    <div className=\"mt-5 rounded-xl border border-zinc-800 bg-black/40 p-4\">\n                      {items.length === 0 ? (\n                        <p className=\"text-sm text-zinc-400\">No item details available.</p>\n                      ) : (\n                        <ul className=\"space-y-3\">\n                          {items.map((item) => (\n                            <li\n                              className=\"flex items-center justify-between rounded-lg border border-zinc-800 bg-zinc-900/60 px-4 py-3\"\n                              key={item.id}\n                            >\n                              <div>\n                                <p className=\"text-base font-medium text-zinc-100\">\n                                  Product #{item.productId}\n                                </p>\n                                <p className=\"text-sm text-zinc-400\">Qty: {item.quantity}</p>\n                              </div>\n                              <p className=\"text-base font-semibold text-zinc-100\">\n                                ${(item.price * item.quantity).toFixed(2)}\n                              </p>\n                            </li>\n                          ))}\n                        </ul>\n                      )}\n                    </div>\n                  ) : null}\n                </article>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}